<!DOCTYPE html>
<html>
<head>
  <title>Dictionary Entry</title>
</head>
<body>
  <h1>Create Dictionary Entry</h1>
  <form id="entry-form">
    <label for="word">Word:</label>
    <input type="text" id="word" name="word" required><br>

    <label for="definition">Definition:</label>
    <textarea id="definition" name="definition" rows="4" required></textarea><br>

    <label for="word-language">Word Language:</label>
    <select id="word-language" name="word-language">
      <!-- You can populate this dynamically from the Server2 /api/v1/languages endpoint -->
      <option value="en">English</option>
      <option value="zh-Hans">Simplified Chinese</option>
      <option value="zh-Hans">Simplified Chinese</option>
    </select><br>

    <label for="definition-language">Definition Language:</label>
    <select id="definition-language" name="definition-language">
      <!-- Same as word language, populate this dynamically -->
    </select><br>

    <input type="submit" value="Submit">
  </form>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const entryForm = document.getElementById('entry-form');
      entryForm.addEventListener('submit', async (e) => {
        e.preventDefault();

        const word = document.getElementById('word').value;
        const definition = document.getElementById('definition').value;
        const wordLanguage = document.getElementById('word-language').value;
        const definitionLanguage = document.getElementById('definition-language').value;

        const data = {
          word,
          definition,
          'word-language': wordLanguage,
          'definition-language': definitionLanguage,
        };

        try {
          const response = await fetch('/api/v1/definition', {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json',
            },
            body: JSON.stringify(data),
          });

          if (response.status === 201) {
            const result = await response.json();
            alert('Entry created successfully');
            console.log('New entry:', result.entry);
            console.log('Total entries:', result.total);
          } else if (response.status === 409) {
            const errorData = await response.json();
            alert(`Word conflict: ${errorData.message}`);
          } else {
            alert('An error occurred while creating the entry');
          }
        } catch (error) {
          alert('Network error: ' + error.message);
        }
      });
    });
  </script>
</body>
</html>
